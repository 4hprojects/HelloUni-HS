<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DSALGO1 Finals – Part 3 (High-Level Tasks)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- External CSS -->
    <link rel="stylesheet" href="/activity/dsalgo1/css/part3.css">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Tab monitoring script -->
    <script src="/activity/dsalgo1/js/tabMonitor.js"></script>
    
    <style>
        /* Additional inline styles */
        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .time-remaining {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-weight: 600;
            z-index: 1000;
            border-left: 4px solid #059669;
        }
        
        .btn-remove-distance {
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.25rem;
            line-height: 1;
        }
        
        @media print {
            .time-remaining, .navigation {
                display: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Time Remaining Display -->
        <div class="time-remaining" id="timeRemaining">
            <i class="fas fa-clock"></i> Time: <span id="timerDisplay">--:--</span>
        </div>
        
        <!-- Header -->
        <header class="header">
            <h1><i class="fas fa-tasks"></i> DSALGO1 Finals – Part 3</h1>
            <p class="subtitle">
                This part contains high-level tasks on BFS (undirected and directed graphs), Minimum Cost Spanning Tree, 
                and graph representations. Answer clearly and show your reasoning where requested.
                Your answers will be automatically saved as you progress.
            </p>
        </header>

        <!-- Student Information Panel -->
        <section class="info-panel">
            <h2><i class="fas fa-user-graduate"></i> Student Information</h2>
            <div class="info-grid">
                <div class="info-item">
                    <span class="info-label">Student ID Number</span>
                    <span class="info-value" id="studentIDNumberDisplay">[loading...]</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Name</span>
                    <span class="info-value" id="studentNameDisplay">[loading...]</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Section</span>
                    <span class="info-value" id="sectionDisplay">[loading...]</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Exam ID</span>
                    <span class="info-value">dsalgo1-finals</span>
                </div>
            </div>
        </section>

        <!-- Main Form -->
        <form id="part3Form">
            <input type="hidden" id="examID" value="dsalgo1-finals">

            <!-- Status Messages -->
            <div id="message" class="message"></div>

            <!-- Part 3A: BFS on Undirected Graph -->
            <section class="section" id="section-3a">
                <div class="section-header">
                    <div class="section-title">
                        <span class="section-icon">A</span>
                        <h2><i class="fas fa-project-diagram"></i> Part 3A: BFS on an Undirected Graph</h2>
                    </div>
                    <span class="section-progress">0/19 (0%)</span>
                </div>
                
                <div class="section-description">
                    <p>Analyze the undirected graph below and answer all related questions.</p>
                    <p class="hint"><strong>Instructions:</strong> Start BFS at vertex <strong>B</strong>. Answer all questions below based only on the graph above.</p>
                </div>

                <!-- Two-column layout for graph and first two questions -->
                <div class="graph-questions-row">
                    <!-- Left: Graph -->
                    <div class="graph-panel">
                        <h3>Graph Visualization</h3>
                        <div class="graph-box small">
                            <svg viewBox="0 0 260 160" class="graph-svg" aria-labelledby="graph-title">
                                <title id="graph-title">Undirected graph with vertices A, B, C, D, E, F</title>
                                <!-- Edges -->
                                <line class="edge" x1="130" y1="30"  x2="80"  y2="80" />
                                <line class="edge" x1="130" y1="30"  x2="180" y2="80" />
                                <line class="edge" x1="80"  y1="80"  x2="50"  y2="130" />
                                <line class="edge" x1="80"  y1="80"  x2="110" y2="130" />
                                <line class="edge" x1="180" y1="80"  x2="210" y2="130" />
                                <!-- Vertices -->
                                <circle class="vertex" cx="130" cy="30" r="16" />
                                <text class="vertex-label" x="130" y="30">A</text>
                                <circle class="vertex" cx="80" cy="80" r="16" />
                                <text class="vertex-label" x="80" y="80">B</text>
                                <circle class="vertex" cx="180" cy="80" r="16" />
                                <text class="vertex-label" x="180" y="80">C</text>
                                <circle class="vertex" cx="50" cy="130" r="16" />
                                <text class="vertex-label" x="50" y="130">D</text>
                                <circle class="vertex" cx="110" cy="130" r="16" />
                                <text class="vertex-label" x="110" y="130">E</text>
                                <circle class="vertex" cx="210" cy="130" r="16" />
                                <text class="vertex-label" x="210" y="130">F</text>
                            </svg>
                        </div>
                    </div>
                    <!-- Right: Questions 1 and 2 -->
                    <div class="questions-panel">
                        <!-- Question 1: Adjacency List -->
                        <div class="input-group">
                            <label>1. Write the adjacency list for the graph.</label>
                            <div class="matrix-input">
                                <div class="matrix-row">
                                    <span class="vertex-label-input">A:</span>
                                    <input type="text" name="p3_1_A" placeholder="e.g., A, B">
                                </div>
                                <div class="matrix-row">
                                    <span class="vertex-label-input">B:</span>
                                    <input type="text" name="p3_1_B" placeholder="e.g., A, B, C">
                                </div>
                                <div class="matrix-row">
                                    <span class="vertex-label-input">C:</span>
                                    <input type="text" name="p3_1_C" placeholder="e.g., A, B">
                                </div>
                                <div class="matrix-row">
                                    <span class="vertex-label-input">D:</span>
                                    <input type="text" name="p3_1_D" placeholder="e.g., A">
                                </div>
                                <div class="matrix-row">
                                    <span class="vertex-label-input">E:</span>
                                    <input type="text" name="p3_1_E" placeholder="e.g., A">
                                </div>
                                <div class="matrix-row">
                                    <span class="vertex-label-input">F:</span>
                                    <input type="text" name="p3_1_F" placeholder="e.g., A">
                                </div>
                            </div>
                        </div>
                        <!-- Question 2: Unique Edges -->
                        <div class="input-group">
                            <label>2. List all unique edges of the graph.</label>
                            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 0.5rem; margin-top: 0.5rem;">
                                <input type="text" name="p3_2_1" placeholder="Edge 1 (e.g., A-B)">
                                <input type="text" name="p3_2_2" placeholder="Edge 2">
                                <input type="text" name="p3_2_3" placeholder="Edge 3">
                                <input type="text" name="p3_2_4" placeholder="Edge 4">
                                <input type="text" name="p3_2_5" placeholder="Edge 5">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Question 3: BFS Visit Order -->
                <div class="input-group">
                    <label>3. Write the BFS visit order starting from B.</label>
                    <div class="bfs-order-container">
                        <input type="text" name="p3_3_1" class="bfs-order-input" maxlength="1" placeholder="1">
                        <span class="order-separator">→</span>
                        <input type="text" name="p3_3_2" class="bfs-order-input" maxlength="1" placeholder="2">
                        <span class="order-separator">→</span>
                        <input type="text" name="p3_3_3" class="bfs-order-input" maxlength="1" placeholder="3">
                        <span class="order-separator">→</span>
                        <input type="text" name="p3_3_4" class="bfs-order-input" maxlength="1" placeholder="4">
                        <span class="order-separator">→</span>
                        <input type="text" name="p3_3_5" class="bfs-order-input" maxlength="1" placeholder="5">
                        <span class="order-separator">→</span>
                        <input type="text" name="p3_3_6" class="bfs-order-input" maxlength="1" placeholder="6">
                    </div>
                </div>

                <!-- Question 4: Final Visited Set -->
                <div class="input-group">
                    <label>4. Show the final visited set after BFS from B finishes.</label>
                    <input type="text" id="p3_4_input" placeholder="Enter vertices separated by spaces (e.g., A B C D E F)">
                    <div id="p3_4_format" style="margin-top: 0.5rem; color: #059669; font-weight: 500;"></div>
                    <textarea id="p3_4" name="p3_4" style="display: none;"></textarea>
                </div>

                <!-- Question 5: Distance Groups -->
                <div class="input-group">
                    <label>5. Group the vertices by distance (in edges) from B.</label>
                    <p class="hint">Start with Distance 0. Use the button to add more distance levels as needed.</p>
                    
                    <div id="distanceGroupsContainer"></div>
                    
                    <button type="button" id="addDistanceBtn" class="btn btn-success">
                        <i class="fas fa-plus"></i> Add Distance Level
                    </button>
                    
                    <textarea id="p3_5" name="p3_5" style="display: none;"></textarea>
                </div>

                <!-- Save Part 3A -->
                <div style="text-align: right; margin-top: 2rem;">
                    <button type="button" id="savePart3ABtn" class="btn btn-success">
                        <i class="fas fa-save"></i> Save Part 3A Progress
                    </button>
                    <span id="savePart3AStatus" style="margin-left: 1rem; color: #059669; font-weight: 500;"></span>
                </div>
            </section>

            <!-- Part 3B: BFS on Directed Graph -->
            <section class="section" id="section-3b">
                <div class="section-header">
                    <div class="section-title">
                        <span class="section-icon">B</span>
                        <h2><i class="fas fa-directions"></i> Part 3B: BFS on a Directed Graph</h2>
                    </div>
                    <span class="section-progress">0/15 (0%)</span>
                </div>
                
                <div class="section-description">
                    <p>Consider a directed graph with the following edges:</p>
                    <ul style="columns: 2; margin: 1rem 0;">
                        <li>A → B</li>
                        <li>A → C</li>
                        <li>A → D</li>
                        <li>B → E</li>
                        <li>C → D</li>
                        <li>D → E</li>
                        <li>E → F</li>
                        <li>F → A</li>
                    </ul>
                    <p class="hint"><strong>Instructions:</strong> Start BFS at vertex <strong>A</strong>. Only follow the direction of arrows (do not go backwards). Enter neighbours in ascending order.</p>
                </div>

                <!-- Question 6: Adjacency List -->
                <div class="input-group">
                    <label>6. Build the adjacency list for the directed graph.</label>
                    <div class="matrix-input">
                        <div class="matrix-row">
                            <span class="vertex-label-input">A:</span>
                            <input type="text" name="p3B_A" placeholder="e.g., B, C, D">
                        </div>
                        <div class="matrix-row">
                            <span class="vertex-label-input">B:</span>
                            <input type="text" name="p3B_B" placeholder="e.g., E">
                        </div>
                        <div class="matrix-row">
                            <span class="vertex-label-input">C:</span>
                            <input type="text" name="p3B_C" placeholder="e.g., D">
                        </div>
                        <div class="matrix-row">
                            <span class="vertex-label-input">D:</span>
                            <input type="text" name="p3B_D" placeholder="e.g., E">
                        </div>
                        <div class="matrix-row">
                            <span class="vertex-label-input">E:</span>
                            <input type="text" name="p3B_E" placeholder="e.g., F">
                        </div>
                        <div class="matrix-row">
                            <span class="vertex-label-input">F:</span>
                            <input type="text" name="p3B_F" placeholder="e.g., A">
                        </div>
                    </div>
                </div>

                <!-- Graph Builder -->
                <div class="graph-builder-container">
                    <h3>Graph Builder (Optional)</h3>
                    <p class="hint">Click two nodes to add a directed edge (arrow). Click on an edge to remove it.</p>
                    <div class="graph-canvas"></div>
                </div>

                <!-- Question 7: BFS Visit Order -->
                <div class="input-group">
                    <label>7. Write the BFS visit order starting from A.</label>
                    <div class="bfs-order-container">
                        <input type="text" name="p3_7_1" class="bfs-order-input" maxlength="1" placeholder="1">
                        <span class="order-separator">→</span>
                        <input type="text" name="p3_7_2" class="bfs-order-input" maxlength="1" placeholder="2">
                        <span class="order-separator">→</span>
                        <input type="text" name="p3_7_3" class="bfs-order-input" maxlength="1" placeholder="3">
                        <span class="order-separator">→</span>
                        <input type="text" name="p3_7_4" class="bfs-order-input" maxlength="1" placeholder="4">
                        <span class="order-separator">→</span>
                        <input type="text" name="p3_7_5" class="bfs-order-input" maxlength="1" placeholder="5">
                        <span class="order-separator">→</span>
                        <input type="text" name="p3_7_6" class="bfs-order-input" maxlength="1" placeholder="6">
                    </div>
                </div>

                <!-- Question 8: Reachable Vertices -->
                <div class="input-group">
                    <label>8. After BFS from A, list all vertices that are <strong>reachable</strong> from A.</label>
                    <input type="text" id="p3_8_input" placeholder="Enter vertices separated by spaces (e.g., A B C D E F)">
                    <div id="p3_8_format" style="margin-top: 0.5rem; color: #059669; font-weight: 500;"></div>
                    <textarea id="p3_8" name="p3_8" style="display: none;"></textarea>
                </div>

                <!-- Question 9: Unreachable Vertices -->
                <div class="input-group">
                    <label>9. Are there any vertices that are <strong>unreachable</strong> from A? If yes, list them. If none, write 'None'.</label>
                    <input type="text" name="p3_9" placeholder="Enter 'None' or vertex names">
                </div>

                <!-- Save Part 3B -->
                <div style="text-align: right; margin-top: 2rem;">
                    <button type="button" id="savePart3BBtn" class="btn btn-success">
                        <i class="fas fa-save"></i> Save Part 3B Progress
                    </button>
                    <span id="savePart3BStatus" style="margin-left: 1rem; color: #059669; font-weight: 500;"></span>
                </div>
            </section>

            <!-- Part 3C: Minimum Cost Spanning Tree -->
            <section class="section" id="section-3c">
                <div class="section-header">
                    <div class="section-title">
                        <span class="section-icon">C</span>
                        <h2><i class="fas fa-tree"></i> Part 3C: Minimum Cost Spanning Tree</h2>
                    </div>
                    <span class="section-progress">0/32 (0%)</span>
                </div>

                <!-- Graph 1: Kruskal's Algorithm -->
                <div class="section-description">
                    <h3>Graph 1 – Use Kruskal's Algorithm</h3>
                    <p>Consider a connected, undirected weighted graph with vertices {A, B, C, D, E} and the following edges:</p>
                    <pre style="background: #f8fafc; padding: 1rem; border-radius: var(--radius-sm); margin: 1rem 0;">
A - B  (weight 2)
A - C  (weight 3)
B - C  (weight 1)
B - D  (weight 4)
C - E  (weight 5)
D - E  (weight 7)</pre>
                </div>

                <!-- Questions 10-11: Kruskal's Algorithm -->
                <div class="input-group">
                    <label>
                        10. List all edges sorted by increasing weight. 
                        <br>
                        <span style="font-size: 0.95rem; color: #666;">
                        11. For each edge, enter the edge and its weight, then check the box if you select it for the MCST using Kruskal's algorithm.
                        </span>
                    </label>
                    
                    <div class="mcst-inputs">
                        <div class="mcst-row">
                            <input type="text" name="p3_10_1_edge" class="edge-input" placeholder="Edge (e.g., B-C)">
                            <input type="text" name="p3_10_1_weight" class="weight-input" placeholder="Weight">
                            <input type="checkbox" name="p3_11_1" class="select-checkbox">
                            <span>Select for MCST</span>
                        </div>
                        <div class="mcst-row">
                            <input type="text" name="p3_10_2_edge" class="edge-input" placeholder="Edge">
                            <input type="text" name="p3_10_2_weight" class="weight-input" placeholder="Weight">
                            <input type="checkbox" name="p3_11_2" class="select-checkbox">
                            <span>Select for MCST</span>
                        </div>
                        <div class="mcst-row">
                            <input type="text" name="p3_10_3_edge" class="edge-input" placeholder="Edge">
                            <input type="text" name="p3_10_3_weight" class="weight-input" placeholder="Weight">
                            <input type="checkbox" name="p3_11_3" class="select-checkbox">
                            <span>Select for MCST</span>
                        </div>
                        <div class="mcst-row">
                            <input type="text" name="p3_10_4_edge" class="edge-input" placeholder="Edge">
                            <input type="text" name="p3_10_4_weight" class="weight-input" placeholder="Weight">
                            <input type="checkbox" name="p3_11_4" class="select-checkbox">
                            <span>Select for MCST</span>
                        </div>
                        <div class="mcst-row">
                            <input type="text" name="p3_10_5_edge" class="edge-input" placeholder="Edge">
                            <input type="text" name="p3_10_5_weight" class="weight-input" placeholder="Weight">
                            <input type="checkbox" name="p3_11_5" class="select-checkbox">
                            <span>Select for MCST</span>
                        </div>
                        <div class="mcst-row">
                            <input type="text" name="p3_10_6_edge" class="edge-input" placeholder="Edge">
                            <input type="text" name="p3_10_6_weight" class="weight-input" placeholder="Weight">
                            <input type="checkbox" name="p3_11_6" class="select-checkbox">
                            <span>Select for MCST</span>
                        </div>
                    </div>
                </div>

                <!-- Question 12: Total Cost -->
                <div class="input-group">
                    <label>12. Give the total cost (sum of weights) of your MCST for Graph 1.</label>
                    <input type="text" name="p3_12" placeholder="Enter total cost">
                </div>

                <!-- Graph 2: Prim's Algorithm -->
                <div class="section-description" style="margin-top: 2rem;">
                    <h3>Graph 2 – Use Prim's Algorithm</h3>
                    <p>Consider another connected, undirected weighted graph with vertices {P, Q, R, S} and the following edges:</p>
                    <pre style="background: #f8fafc; padding: 1rem; border-radius: var(--radius-sm); margin: 1rem 0;">
P - Q  (weight 4)
P - R  (weight 2)
Q - R  (weight 1)
Q - S  (weight 5)
R - S  (weight 3)</pre>
                    <p class="hint"><strong>Instructions:</strong> Start Prim's algorithm from vertex <strong>P</strong>. Show the order in which edges are added to the tree.</p>
                </div>

                <!-- Question 13: Prim's Algorithm -->
                <div class="input-group">
                    <label>13. Show the order in which edges are added to the tree when you apply Prim's algorithm starting at P.</label>
                    <div class="prim-inputs">
                        <div class="prim-row">
                            <select name="p3_13_1_edge" class="edge-select">
                                <option value="">Select edge</option>
                                <option value="P-Q">P-Q (4)</option>
                                <option value="P-R">P-R (2)</option>
                                <option value="Q-R">Q-R (1)</option>
                                <option value="Q-S">Q-S (5)</option>
                                <option value="R-S">R-S (3)</option>
                            </select>
                            <select name="p3_13_1_order" class="order-select">
                                <option value="">Select order</option>
                                <option value="1">1st</option>
                                <option value="2">2nd</option>
                                <option value="3">3rd</option>
                            </select>
                        </div>
                        <div class="prim-row">
                            <select name="p3_13_2_edge" class="edge-select">
                                <option value="">Select edge</option>
                                <option value="P-Q">P-Q (4)</option>
                                <option value="P-R">P-R (2)</option>
                                <option value="Q-R">Q-R (1)</option>
                                <option value="Q-S">Q-S (5)</option>
                                <option value="R-S">R-S (3)</option>
                            </select>
                            <select name="p3_13_2_order" class="order-select">
                                <option value="">Select order</option>
                                <option value="1">1st</option>
                                <option value="2">2nd</option>
                                <option value="3">3rd</option>
                            </select>
                        </div>
                        <div class="prim-row">
                            <select name="p3_13_3_edge" class="edge-select">
                                <option value="">Select edge</option>
                                <option value="P-Q">P-Q (4)</option>
                                <option value="P-R">P-R (2)</option>
                                <option value="Q-R">Q-R (1)</option>
                                <option value="Q-S">Q-S (5)</option>
                                <option value="R-S">R-S (3)</option>
                            </select>
                            <select name="p3_13_3_order" class="order-select">
                                <option value="">Select order</option>
                                <option value="1">1st</option>
                                <option value="2">2nd</option>
                                <option value="3">3rd</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Question 14: Total Cost -->
                <div class="input-group">
                    <label>14. Give the total cost (sum of weights) of your MCST for Graph 2.</label>
                    <input type="text" name="p3_14" placeholder="Enter total cost">
                </div>

                <!-- Save Part 3C -->
                <div style="text-align: right; margin-top: 2rem;">
                    <button type="button" id="savePart3CBtn" class="btn btn-success">
                        <i class="fas fa-save"></i> Save Part 3C Progress
                    </button>
                    <span id="savePart3CStatus" style="margin-left: 1rem; color: #059669; font-weight: 500;"></span>
                </div>
            </section>

            <!-- Navigation & Submit -->
            <nav class="navigation">
                <div class="controls">
                    <a href="/activity/dsalgo1/dsalgo1-finals-part2" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Back to Part 2
                    </a>
                    
                    <div class="progress-bar">
                        <div class="progress-info">
                            <span id="answeredCount">0</span> of 46 answered
                            <span id="progressPercentage">0%</span>
                        </div>
                        <div class="progress-track">
                            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary" id="submitBtn">
                        <i class="fas fa-paper-plane"></i> Save Part 3 and Go to Part 4 (0/46)
                    </button>
                </div>
                
                <!-- Quick navigation hint -->
                <div style="text-align: center; margin-top: 10px; font-size: 0.875rem; color: #666;">
                    <small>Tip: Answers are auto-saved every 30 seconds. Use Ctrl+S to save manually.</small>
                </div>
            </nav>
        </form>
    </div>

    <!-- Timer Script -->
    <script>
        // Timer functionality (60 minutes for the exam)
        let examTimer = 60 * 60;
        const timerDisplay = document.getElementById('timerDisplay');
        const timeRemaining = document.getElementById('timeRemaining');
        
        function updateTimer() {
            if (!timerDisplay) return;
            
            const minutes = Math.floor(examTimer / 60);
            const seconds = examTimer % 60;
            timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            if (examTimer <= 600) { // 10 minutes
                timeRemaining.style.borderLeftColor = '#ef4444';
                timeRemaining.style.color = '#ef4444';
                
                if (examTimer <= 300) { // 5 minutes
                    timeRemaining.style.opacity = (Math.sin(Date.now() / 500) + 1) / 2;
                }
            }
            
            if (examTimer > 0) {
                examTimer--;
            }
        }
        
        let timerInterval;
        document.addEventListener('DOMContentLoaded', () => {
            timerInterval = setInterval(updateTimer, 1000);
        });
        
        // Prevent accidental refresh
        window.addEventListener('beforeunload', (e) => {
            const form = document.getElementById('part3Form');
            if (form) {
                const answeredCount = Object.keys(window.currentAnswers || {}).length;
                if (answeredCount > 0 && !window.isNavigatingAway) {
                    e.preventDefault();
                    e.returnValue = 'You have unsaved answers. Are you sure you want to leave?';
                }
            }
        });
    </script>

    <!-- External JavaScript -->
    <script src="/activity/dsalgo1/js/part3.js" defer></script>
</body>
</html>
